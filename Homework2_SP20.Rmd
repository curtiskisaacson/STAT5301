---
title: 'Stat 5301: Homework 2'
output:
  word_document: default
  pdf_document: default
  html_document:  default
date: "Due Friday, January 24th, 2020"
fontsize: 11pt
---

**Instructions**: Answer all questions and submit the problems in order, making sure that the computer output and discussion are placed together.  (Do not put the computer output at the end of the homework.)  Raw computer output is not acceptable. Make it clear what parts of the output are relevant and show how they answer the questions posed in the homework.  Make sure problem numbers and each part (a, b, c ...) are clearly labeled.  You may work together on the homework, but do not copy any part of a homework. Each student must produce his/her own homework to be handed in. Homework is to be submitted via Carmen. 

Refer to the lecture notes for examples of R code. Additional help is provided by the links in the Installation of R and RStudio document.  When the assignement is completed, please upload two files, your .Rmd file and the output as a .pdf file. Filenames for each homework assignment will have the following format:  lastname_firstname_hw#.Rmd which contains the text and R code, and lastname_firstname_hw#.pdf, which is a copy of the output generated by knitting lastname_firstname_hw#.Rmd.  For example, for homework 2, I would submit kelbick_nicole_hw2.Rmd and kelbick_nicole_hw2.pdf.  

NOTE:  When converting to a Word file first, you may edit page breaks but nothing else at this time.

To learn how to comment out sections in a Rmarkdown file, check out the text in this .Rmd file right after this sentence.  It should appear in green color.  Any text between `<!--` and `-->` will be considered plain text.  This is useful for debugging purposes.

<!--
This is a test.  Nothing should appear when the document is knitted.
```{r}
rep(5,5)
```
-->

\newpage
<!--  \newline will add an extra line if so desired  -->

**Question 1**
```{r}
stemplotdata = c(2, 5, 5, 6, 7, rep(8,7), 9, 9, 11, 12, 12, 12, 14, 14, 15, 15, 16, 16, 16, rep(17, 6), 18, 18, 20, 21, 21, 21, 22, 22, 24, 25, 35)
stem(stemplotdata)

```


The values represented in the previous stemplot have been divided into stems and leaves where the stems are the tens digit and the leaves are the  ones digit.  For example, the first value has a 0 for a stem and a 2 as a leaf.  This is the equivalent to the number 02 or just 2.  Refer to the previous stemplot to answer the following questions.

(a) How would you describe the shape of the distribution?  Where do most of the values seem to be concentrated?  Do there appear to be any outliers?  Why or why not?

    I would describe the distribution as right skewed. Most of the values seem concentrated between 5 and 20. There appears to be one outlier at 35 because it is so far away from the rest of the values 

(b)  How many observations are represented by the stemplot?
    
    42

(c)  Calculate the median of this dataset by hand (that is, do not use software, except perhaps to verify).  Briefly explain/show how you did your calculations.
    
    Since there are 42 observations, that means the median is either between the 21st and 22nd observation. Thus we must average the two. The 21st observation, after counting from the start is 15 and the 22nd is also 15 so the median is 15

(d)  Calculate Q1 = 25th percentile and Q3 = 75th percentile of this dataset by hand.  Briefly explain/show how you did your calculations.  NOTE: there are different methods of calculating a percentile.  One possible way is to note that Q1 can be viewed as the median of the lower half of the data.  Similarly, Q3, the 75th percentile, is akin to the median of the upper half of the data.

    For this problem, I used the possible way discussed in the problem. The median of the lower half of the data, Q1, is the median for data points from 1 to 21 which is the 11th data point, which is 8. The median of the upper half of the data, Q3, is the media for the datapoints 21 to 42 which is 32nd data point, which is 18

(e)  Based on your answers to parts (c) and (d), write out the 5-Number Summary for the values in the stem plot.

  Min: 2
  Q1: 8
  Median: 15
  Q3: 18
  Max: 35

(f)   Use the following two functions on stemplotdata to obtain the 5-Number Summary via  R:   fivenum() and  summary().  Compare the results. Notice how the Q3) values differ.  Different methods yield slightly different results.  This is fine.

```{r}
fivenum(stemplotdata)
```

    My results are the same as the r calcuations, though the question suggests that they should be different. I think it is because my counting may have been off when calculating Q3. I should have started at 22 - 42 not 21 to 42.

(g)   Calculate the Interquartile Range (IQR) for the data using the results of  fivenum() in part (f).  Using the 1.5xIQR rule for determining potential outliers, does the data suggest there are potential outliers?  Explain why or why not.  Show work where possible.

    To calculate IQR you subtract Q1 from Q3
    Q3 - Q1 = IQR
    18 - 8 = 10
    
    1.5* 10 = 15
    Thus, by using the 1.5xIQR rule, if a number is 15 units above Q3 or 15 units below Q1, it can be considered an outlier
    18 + 15 = 33
    8 - 15 = -7
    
    Therefore
    Any number greater than 33 is an outlier. Thus there is an outlier at Observation 42: 35
    Any number less than -7 is an outlier. Thus there are no lower bound outliers


(h)   Draw the boxplot using  R corresponding to your results from   fivenum().  Instead of having  boxplot() do everything for us, we are going to give it 5 values corresponding to the the 3 quartiles as well as the values where the whiskers end (lower whisker limit, Q1, Q2, Q3, upper whisker limit).  Then you will add any potential points to the plot via the  points() command.  Use the following code as a guideline.    The  points() command allows you to add potential outliers based on your answer to part (g). Use  ylim=c(0,40) to define the lower and upper boundaries of your y-axis to allow for extra space for potential outliers.  

Let LB = Q1 - 1.5xIQR and UB = Q3 + 1.5xIQR, for lower bound and upper bound, respectively.  Let MIN be the minimum value of the dataset and MAX be the maximum value of the dataset.  The whiskers stop at the minimum and/or maximum values in the dataset if LB < MIN and/or MAX < UB.  Otherwise, the bottom whisker stops at LB if an outlier exists on the lower end and the upper whisker stops at UB if an outlier exists at the upper end of the data.  **So the five values you will be supplying to boxplot() are**

**(max[LB, MIN], Q1, Q2, Q3, min[UB, MAX])**

Note:  The reason I am doing it this very inconvenient way is to get you to understand how the boxplot is drawn. After this problem, you can just use  boxplot() the usual way by supplying the full dataset.  This is the best alternative to actually drawing it by hand that I could come up with.  You learn it best by constructing it yourself.

Below is an example of some code to draw your boxplot.  You will need to replace the values in the example below with the corresponding ones based on the stemplot data.  

The following modification is not necessary but something you may find useful in the Rmarkdown code at the beginning of an  R chunk.

{r, echo=TRUE, fig.height=3, fig.width=3, fig.align="center"}

You don't need  fig.height and  fig.width commands. Fiddle around with them if you want to. If you ever DO NOT want to display the  R commands, use  echo=FALSE.  For homework, though, use  echo=TRUE, which is the default.


```{r, echo=TRUE, fig.height=3, fig.width=3, fig.align="center"}
boxplot(c(15, 20, 25, 30, 35),ylim=c(0,40))
text(x=rep(1.4,5), y=c(15, 20, 25, 30, 35), labels=c("Min", "Q1", "Q2","Q3", "Max"), cex=0.7)
points(1, 10)
```


```{r, echo=TRUE, fig.height= 3, fig.width=3, fig.align = "center"}
#cleaning up the numbers I am given/found in previous problems
fiveNumSummary = c(2,8,15,18,33 )

#plotting boxplot
boxplot(fiveNumSummary,ylim=c(0,40))

#adding text(x position, y position, labels, cex)
text(x = rep(1.4,5), y = c(2,8,15,18,33), labels = c("Min", "Q1", "Q2", "Q3", "Max"), cex = 0.7  )

#adding the outlier point at 35
points(1, 35)



```

**Question 2**

**Note:** The `load("bloodpressure.RData")` command loads in the data if `bloodpressure.RData` is in your working directory.  You can find your working directory by typing `getwd()` and place the file in whatever directory shows up there.  Alternatively, you can set your working directory with the command `setwd()` and insert the desired directory path in quotes, e.g. `setwd(C:/Users/kelbick.1/Documents/5301/HW2")`, followed by `load("bloodpressure.RData")`. Yet another alternative is to type the full path and file name into `load` such as  

```{r}
   load("C:/Users/kelbick.1/Documents/Teaching/5301/Misc/HW/HW2/bloodpressure.RData")
```


Load the R dataset  bloodpressure.RData.  (See note above.) It contains the result of a drug study looking at the effectiveness of a potential new blood pressure medicine designed to help reduce high blood pressure. Look at and explore the dataset.  The dataframe is called  BP.   names(BP) will list the column names.  

Note:  Another useful command is  attach().  It allows you to attach a data set to the search path in such a way that the columns of data in the dataset can now be accessed by their column names directly instead of haveing to first prefix it with the dataset name. For example, if you submit the command  attach(BP), you can now access the Age column by typingAge rather than  BP$Age. To remove it from the search path, use  deattach(BP).  Exiting R will do this automatically .


(a)  Provide appropriate summary statistics for each of the variables in the dataset (excluding the ID variable).  You may find the  table() command useful in addition to ones included in the lecture notes.  Use  help(table) to find out more about it.

```{r}
load ("bloodpressure.RData")
table()
```

   


(b)  Create a side-by-side plot of two histograms. The first should be a histogram of  DiffBP for the  Placebo group and the second one a 
histogram of  DiffBP for the  Drug group.  Refer to the tutorial in HW1 about using  par(mfrow=c(1,2)) to do this.  It is a good idea to reset back to a single plot by using  par(mfrow=c(1,1)) when finished looking at side-by-side plots.  Make sure that the x-axes and y-axes have the same limits and both plots have the same breakpoints for the bars of the histogram.  Use  help(hist) to find out about various arguments you can supply to this function (breaks= is useful for defining break points) to modify how the final plot looks as well as  help(par) for additional plotting parameters you may want to include.  


```{r}
par(mfrow=c(1,2))
hist(BP$DiffBP[BP$Group=="Placebo"],
     breaks = 5,
     main = "DiffBP for the Placebo Group",
     xlab = "Difference in Blood Pressure (BPM)",
     xlim = c(-10, 30),
     ylim = c(0,10)
     )

hist(BP$DiffBP[BP$Group=="Drug"],
     breaks = 10,
     main = "DiffBP for the Drug Group",
     xlab = "Difference in Blood Pressure (BPM)",
     xlim = c(-10, 30),
     ylim = c(0,10)
     )
par(mfrow=c(1,1))
#After a TON of fiddling, this is the closest I can get to having two breaks be the same. I can get everything besides these two, but it seems to be some sort of "smart" break that disallows me setting them to be the same. Things such as 10 and 10 sets the Placebo histogram to be 12 and the drug group to be actually at 10 breaks. I inputed 5 and 10, respectively, because it ended up looking the best
```


Describe and compare the shapes of the distributions as well as where they are centered and their variability.  Do there appear to be any outliers in either group?

    For the placebo group, it seems as though it is mildly left skewed , and it is tighly centered around 5 with no outliers
    For the drug group, it seems that it is fairly symmetric with a loose center around 10. There appears to be no outliers

(c)  Provide summary statistics for DiffBP **by group** (Drug vs Placebo).  Do the histograms and summary statistics suggest that the new blood pressure drug has the potential to significantly reduce high blood pressure?  Why or why not?

```{r}
print.noquote("5 number summary for placebo group:")
fivenum(BP$DiffBP[BP$Group=="Placebo"])
print.noquote("Mean for placebo group:")
mean(BP$DiffBP[BP$Group=="Placebo"])
print.noquote("")

print.noquote("5 number summary for drug group:")
fivenum(BP$DiffBP[BP$Group=="Drug"])
print.noquote("Mean for drug group:")
mean(BP$DiffBP[BP$Group=="Drug"])


```

The histograms do provide significant evidence to show that the new blood pressure drug has potential to significantly reduce high blood pressure because the mean and median difference in blood pressure is much larger than that of the placebo group

**Question 3**

A common belief is that the normal body temperature is 98.6 degrees Fahrenheit.  A study published in 1992 in the *Journal of the American Association* indicated 98.2 degrees Fahrenheit might be more accurate.  The study reported the standard deviation to be around 0.7 degrees Fahrenheit.  Assume that a Normal model appropriately describes the distribution of body temperatures.  Show work using Z-scores since you will need this for the exams.  You may use R to find the actual probabilities although know how to read the Normal table, which will also be used for exams.

(a)  Assuming 98.2 degrees Fahrenheit is a more accurate measure of the true mean for the distribution of body temperatures, what proportion of people would have body temperatures not exceeding 98.6 degrees Fahrenheit?

    m = 98.2
    s = .7
    
    P(x<98.6) == 1 - P(x>98.6)
    z = (98.6-98.2)/.7 = .4/.7 = .5714
    P(z>.5714) = 1- P(z<.5714) = 1 - .7157 = .2843
    
    Around 71% of people have body temps not exceeding 98.6 and 28% do if that is the true mean
    

(b)  What proportion of people have body temperatures between 98.2 and 98.6 degrees Fahrenheit?

    .71 - .5 = .21
    Roughly around 21% of people have a body temp between 98.2 and 98.6

(c)  What range of body temperatures fall into the top 30%? (Start by finding the body temperature such that 30% of people have temperatures above this value.)
    
    What we are trying to find: t 
    t is a z score where
    P(z>t) = .3
    but we must flip it so we can find a value that can be found on the z score table thus 
    P(z<t) = .7
    Look it up using the table
    t = .53
    
    (temp - mean temp)/standard deviation = t = .53
    
    temp - 98.2 = .371
    
    temp = 98.571 degrees to fall in the top 30%
    
    
    

